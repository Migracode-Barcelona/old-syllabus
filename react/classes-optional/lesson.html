
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Class components (optional) Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../../node/" />
    
    
    <link rel="prev" href="../week-4/lesson.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Course</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Before you start
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../others/lesson0.html">
            
                <a href="../../others/lesson0.html">
            
                    
                    Week 0 - Introduction and basic setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../others/house-rules.html">
            
                <a href="../../others/house-rules.html">
            
                    
                    House Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../CODE_OF_CONDUCT.html">
            
                <a href="../../CODE_OF_CONDUCT.html">
            
                    
                    Code of Conduct
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../html-css/">
            
                <a href="../../html-css/">
            
                    
                    HTML/CSS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../html-css/week-1/lesson.html">
            
                <a href="../../html-css/week-1/lesson.html">
            
                    
                    Week 1 - Semantic HTML and CSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../html-css/week-2/lesson.html">
            
                <a href="../../html-css/week-2/lesson.html">
            
                    
                    Week 2 - Responsive Web and layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../html-css/week-3/lesson.html">
            
                <a href="../../html-css/week-3/lesson.html">
            
                    
                    Week 3 - Bootstrap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../js-core/">
            
                <a href="../../js-core/">
            
                    
                    JavaScript I
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../js-core/week-04/lesson.html">
            
                <a href="../../js-core/week-04/lesson.html">
            
                    
                    Week 4 - Hello JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../js-core/week-05/lesson.html">
            
                <a href="../../js-core/week-05/lesson.html">
            
                    
                    Week 5 - Expressions and loops
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../js-core/week-06/lesson.html">
            
                <a href="../../js-core/week-06/lesson.html">
            
                    
                    Week 6 - Arrays and callbacks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../js-core-2/">
            
                <a href="../../js-core-2/">
            
                    
                    JavaScript II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../js-core-2/week-07/lesson.html">
            
                <a href="../../js-core-2/week-07/lesson.html">
            
                    
                    Week 7 - Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../js-core-2/week-08/lesson.html">
            
                <a href="../../js-core-2/week-08/lesson.html">
            
                    
                    Week 8 - JS in the Browser
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../js-core-2/week-09/lesson.html">
            
                <a href="../../js-core-2/week-09/lesson.html">
            
                    
                    Week 9 - More JS in the Browser 
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../js-core-3/">
            
                <a href="../../js-core-3/">
            
                    
                    JavaScript III
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../js-core-3/week-10/lesson.html">
            
                <a href="../../js-core-3/week-10/lesson.html">
            
                    
                    Week 10 - ES6 and debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../js-core-3/week-11/lesson.html">
            
                <a href="../../js-core-3/week-11/lesson.html">
            
                    
                    Week 11 - Unit tests and TDD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../js-core-3/week-12/lesson.html">
            
                <a href="../../js-core-3/week-12/lesson.html">
            
                    
                    Week 12 - Recap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../">
            
                <a href="../">
            
                    
                    React
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../week-1/lesson.html">
            
                <a href="../week-1/lesson.html">
            
                    
                    Week 13 - React 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../week-2/lesson.html">
            
                <a href="../week-2/lesson.html">
            
                    
                    Week 14 - Reacting to Changes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../week-3/lesson.html">
            
                <a href="../week-3/lesson.html">
            
                    
                    Week 15 - Fetching Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../week-4/lesson.html">
            
                <a href="../week-4/lesson.html">
            
                    
                    Routing (optional)
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7.5" data-path="lesson.html">
            
                <a href="lesson.html">
            
                    
                    Class components (optional)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../node/">
            
                <a href="../../node/">
            
                    
                    Node/DB
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../node/week-13/lesson.html">
            
                <a href="../../node/week-13/lesson.html">
            
                    
                    Week 16 - Node and Express 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../node/week-14/lesson.html">
            
                <a href="../../node/week-14/lesson.html">
            
                    
                    Week 17 - More APIs in Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../db/week-1/lesson.html">
            
                <a href="../../db/week-1/lesson.html">
            
                    
                    Week 18 - Introduction to SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../../db/week-2/lesson.html">
            
                <a href="../../db/week-2/lesson.html">
            
                    
                    Week 19 - More SQL and integration with NodeJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../../db/week-3/lesson.html">
            
                <a href="../../db/week-3/lesson.html">
            
                    
                    Week 20 - SQL with NodeJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../../db/week-4/lesson.html">
            
                <a href="../../db/week-4/lesson.html">
            
                    
                    Week 21 - NodeJS Workshop
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Useful information</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../others/useful-links.html">
            
                <a href="../../others/useful-links.html">
            
                    
                    Useful links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../others/PRACTICES.html">
            
                <a href="../../others/PRACTICES.html">
            
                    
                    Coding Standards and Best Practices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../others/career-development.html">
            
                <a href="../../others/career-development.html">
            
                    
                    Career Development
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Other resources</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../others/git.html">
            
                <a href="../../others/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../others/coding-101.html">
            
                <a href="../../others/coding-101.html">
            
                    
                    Coding 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../others/aws-workshop-2.html">
            
                <a href="../../others/aws-workshop-2.html">
            
                    
                    AWS - DynamoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" >
            
                <a target="_blank" href="https://github.com/Thomas-Stewart/syllabus/tree/master/java">
            
                    
                    Java module
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">For Mentors</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../others/mentors-guide.html">
            
                <a href="../../others/mentors-guide.html">
            
                    
                    Mentors Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../others/mentors-weeks.html">
            
                <a href="../../others/mentors-weeks.html">
            
                    
                    Mentors Weekly Contents
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Class components (optional)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="react-class-components-optional">React Class Components (Optional)</h1>
<p><strong>What will we learn today?</strong></p>
<ul>
<li><a href="#class-components">Class Components</a></li>
<li><a href="#state-in-class-components">State in Class Components</a></li>
<li><a href="#unmounting">Unmounting</a></li>
<li><a href="#class-component-lifecycle">Class Component Lifecycle</a></li>
<li><a href="#fetching-data-with-class-components">Fetching Data with Class Components</a></li>
</ul>
<h2 id="class-components">Class Components</h2>
<p>So far we have looked at components which are just functions (which are called <em>function components</em>), but there is another way of creating React components using the <code>class</code> keyword. Let&apos;s look at an example (<a href="https://codesandbox.io/s/class-components-1zmoz1817j?file=/src/Greeting.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// Class component</span>
<span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Function component</span>
<span class="token keyword">const</span> <span class="token function-variable function">Greeting</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Instead of getting props through the first argument of the component function, the class component gets props from <code>this.props</code> (<a href="https://codesandbox.io/s/class-components-1zmoz1817j?file=/src/Mentor.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Mentor</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Here are the steps to follow to convert from a function component into a class component:</p>
<ol>
<li>Import the <code>Component</code> variable by changing the React import to: <code>import React, { Component } from &apos;react&apos;;</code></li>
<li>Create a new <code>class</code> that extends the component: <code>class MyComponentName extends Component {}</code></li>
<li>Inside the class, create a render method: <code>render() {}</code></li>
<li>Copy and paste the contents of the function component into the <code>render</code> method</li>
<li>Replace any references to <code>props</code> with <code>this.props</code></li>
<li>Delete the old function component</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application that you created last week.</td>
</tr>
<tr>
<td style="text-align:left">2. Convert the <code>Logo</code> component from a function component into a class component.</td>
</tr>
<tr>
<td style="text-align:left">3. Convert the <code>CaughtPokemon</code> component into a class component.</td>
</tr>
<tr>
<td style="text-align:left">4. Convert the <code>BestPokemon</code> component into a class component.</td>
</tr>
</tbody>
</table>
<h3 id="when-you-should-use-function-components-or-class-components">When you should use function components or class components?</h3>
<p>Classes are an older method for creating components in React. Even though they are older, they will still continue to work for a long time. Because of this, there are <strong>many</strong> React components written using classes. You will likely still encounter them when developing with React.</p>
<p>Before Hooks were released classes were the only way to access state and lifecycle (similar to effects). The rule of thumb now is that new components should be written using function components with Hooks, but class components don&apos;t need to be updated.</p>
<h3 id="class-methods">Class Methods</h3>
<p>Class <em>methods</em> are similar to nested &quot;handler&quot; functions inside function components. Let&apos;s take a look at an example (<a href="https://codesandbox.io/s/class-methods-in-react-13omkro30j?file=/src/Hello.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">sayHello</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Hello from Hello component!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sayHello<span class="token punctuation">}</span><span class="token operator">&gt;</span>Say hello<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Unlike nested functions, we can&apos;t use just the name of the function in the <code>onClick</code> prop. We have to use <code>this</code> first, because the method is attached to the class.</p>
<p>Notice how we use a slightly different syntax for the <code>sayHello</code> method than the <code>render</code> method? There is a reason for this, but it is quite complicated and mostly irrelevant. The rule of thumb is to always use this syntax:</p>
<pre class="language-"><code class="lang-js"><span class="token function-variable function">methodName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Except</strong> for the <code>render</code> method (and a handful of others which we&apos;ll talk about later).</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise B</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application and open the <code>Logo.js</code> file.</td>
</tr>
<tr>
<td style="text-align:left">2. Add a method named <code>logWhenClicked</code> to the <code>Logo</code> component (hint: remember to use the correct syntax).</td>
</tr>
<tr>
<td style="text-align:left">3. Within the <code>logWhenClicked</code> method, <code>console.log</code> a message (it doesn&apos;t matter what the message is).</td>
</tr>
<tr>
<td style="text-align:left">4. Add a <code>onClick</code> handler to the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><span class="token punctuation">&gt;</span></span></code> that will call <code>this.logWhenClicked</code> (hint: look at the <code>Hello</code> component above).</td>
</tr>
<tr>
<td style="text-align:left">5. In your web browser, try clicking on the image. What do you see in the JavaScript console?</td>
</tr>
</tbody>
</table>
<h2 id="state-in-class-components">State in Class Components</h2>
<p>Accessing state in class components is a bit different than with function components. We&apos;re going to use the <code>Counter</code> component we looked at previously:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      Count<span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now let&apos;s look at the equivalent version in a class (<a href="https://codesandbox.io/s/class-component-with-state-wtzte?file=/src/App.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        Count<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>There&apos;s a lot going on here! Let&apos;s break it down into pieces.</p>
<h3 id="state-initialisation">State initialisation</h3>
<p>Unfortunately, React prevents us from using <code>useState</code> inside class components and we have to use alternatives. To initialise state we have to assign a class property called <code>state</code>:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This creates a new state variable called <code>count</code>. Any value you assign will be the initial value of the state variable, so here we initialise to <code>0</code>.</p>
<p>Unlike <code>useState</code>, you can initialise multiple state variables at once, like this:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    isCountingDown<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="defining-the-increment-handler-function">Defining the <code>increment</code> handler function</h3>
<p>Another difference in the class is that we don&apos;t define a &quot;normal&quot; function as the <code>increment</code> handler function. We also don&apos;t define it inside the <code>render</code> method, as you might expect.</p>
<p>Instead we define <code>increment</code> as a class method (<a href="#class-methods">see above</a> for a reminder):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This also means that we have to change how we use the handler function in our JSX:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">...</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="accessing-state-variables">Accessing state variables</h3>
<p>Since we can&apos;t use <code>useState</code>, it also means that we don&apos;t have access to the <code>count</code> variable. Instead our <code>count</code> state lives inside <code>this.state</code>:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        Count<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
        <span class="token operator">...</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We have just swapped <code>count</code> with <code>this.state.count</code>. Otherwise it works exactly the same.</p>
<h3 id="updating-state-with-thissetstate">Updating state with <code>this.setState</code></h3>
<p>The final piece is how we update state variables. Again, because we can&apos;t use <code>useState</code>, we don&apos;t have access to <code>setCount</code>. Instead we use a special function called <code>this.setState</code>:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      state<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This function is similar to <code>setCount</code> because it does two things: </p>
<ol>
<li>Updates the state variable</li>
<li>Triggers a re-render</li>
</ol>
<p>One difference is that <code>this.setState</code> can update multiple state variables at once:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  isCountingDown<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="updating-state-based-on-previous-state">Updating state based on previous state</h3>
<p>You may have noticed that our <code>Counter</code> app isn&apos;t very useful. It can only count to 1! This is because <code>this.setState</code> has one more difference: if you need to update some state based on the previous state, then we need to pass a callback instead of an object (<a href="https://codesandbox.io/s/class-component-updating-state-based-on-previous-state-08itp?file=/src/App.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">previousState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        count<span class="token operator">:</span> previousState<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        Count<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now we can count up as much as we like!</p>
<p>This is because React can &quot;delay&quot; <code>this.setState</code> executing for performance reasons. By using a callback function, we ensure that we are computing the new state with the correct version of the old state and not an outdated one. This problem is one of the reasons why <code>useState</code> was created.</p>
<h3 id="recap">Recap</h3>
<p>Let&apos;s recap what we&apos;ve learnt about React state:</p>
<ul>
<li>We initialise state by assigning a <code>state</code> class property to an object with whatever initial state we want (e.g. <code>{ something: &apos;hello&apos; }</code>)</li>
<li>We can read or render state by using the <code>this.state</code> variable (e.g. <code>this.state.something</code>)</li>
<li>We can change state using the <code>this.setState()</code> method and by passing the piece of state we want to update (e.g. <code>this.setState({ something: &apos;hi&apos; })</code>)</li>
<li>If we need to read the previous state to be able to calculate the new state, then we must use a callback function with <code>this.setState()</code> (e.g. <code>this.setState((previousState) =&gt; { return { something: previousState.something + 1 } })</code>)</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application and open the <code>CaughtPokemon.js</code> file.</td>
</tr>
<tr>
<td style="text-align:left">2. Set the initial state by assigning the <code>state</code> class property to an object. Then make the initial state have 0 <code>caughtPokemon</code>.</td>
</tr>
<tr>
<td style="text-align:left">3. Change the <code>CaughtPokemon</code> component to render <code>this.state.caughtPokemon</code> instead of hard-coding 0. Do you expect anything to have changed in your web browser?</td>
</tr>
<tr>
<td style="text-align:left">4. Add a <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span></code> with the text &quot;Catch Pokemon&quot; to the <code>CaughtPokemon</code> component.</td>
</tr>
<tr>
<td style="text-align:left">5. Create an <code>catchPokemon</code> method within the <code>CaughtPokemon</code> class.</td>
</tr>
<tr>
<td style="text-align:left">6. Add a <code>onClick</code> handler to the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span></code> we just created that will call the <code>catchPokemon</code> method.</td>
</tr>
<tr>
<td style="text-align:left">7. Within the <code>catchPokemon</code> method, use <code>this.setState()</code> to change <code>caughtPokemon</code> to 1.</td>
</tr>
<tr>
<td style="text-align:left">8. Update the <code>catchPokemon</code> method to increase the number of <code>caughtPokemon</code> by 1 every time the button is clicked (hint: we need to use the previous state to calculate the new state).</td>
</tr>
</tbody>
</table>
<h2 id="unmounting">Unmounting</h2>
<p>So far we&apos;ve looked at components that are always rendered in the browser. However (and this is often the case in large applications), we might want to control whether components are shown or not. Let&apos;s look at a Toggle component (<a href="https://codesandbox.io/s/unmounting-with-class-components-xmo8oo514?file=/src/Toggle.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">Message</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token constant">I</span>&apos;m shown when <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShown is <span class="token boolean">true</span> &#x2705;<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Toggle</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    isShown<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">toggle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">previousState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> isShown<span class="token operator">:</span> <span class="token operator">!</span>previousState<span class="token punctuation">.</span>isShown <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShown <span class="token operator">?</span> <span class="token operator">&lt;</span>Message <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>toggle<span class="token punctuation">}</span><span class="token operator">&gt;</span>Toggle<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If you open up dev tools, you will see that the element changes based on the <code>isShown</code> state. The hidden element is not hidden with CSS, it is actually removed from the DOM. This is because <code>this.state.isShown</code> is <code>false</code> which means the Toggle component returns <code>null</code> for that part of the JSX. If you return <code>null</code> in JSX then React will render nothing at all.</p>
<h2 id="class-component-lifecycle">Class Component Lifecycle</h2>
<p>When a class component is within the DOM, we call it <em>mounted</em>. When a component is removed from the DOM, we call it <em>unmounted</em>. When we change state like in the unmounting example above, we can switch between these statuses. This gives us a clue that components go through a <em>lifecycle</em> of different statuses. We have seen 2 of the statuses: mounting and unmounting, there is also a third called <em>updating</em>.</p>
<p>We can hook into this lifecycle through special component methods that are added by React&apos;s <code>Component</code> class. They are run at different points of the lifecycle, often before and after they change to a different status. The method names contain <code>will</code> or <code>did</code> based on whether they run before or after a status change.</p>
<p>This diagram shows the React component lifecycle:</p>
<p><img src="../assets/lifecycle.png" alt="React component lifecycle"></p>
<p>Let&apos;s look at how we can use one of the lifecycle methods (<a href="https://codesandbox.io/s/simple-class-component-lifecycle-m5z2v36x1y?file=/src/Lifecycle.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">Lifecycle</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;componentDidMount&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> application that we have been working on for the last 2 weeks and open the <code>CaughtPokemon.js</code> file.</td>
</tr>
<tr>
<td style="text-align:left">2. Add a <code>componentDidMount</code> method to the <code>CaughtPokemon</code> component. Within this method add a <code>console.log(&apos;componentDidMount&apos;)</code>. You don&apos;t need to return anything from this method.</td>
</tr>
<tr>
<td style="text-align:left">3. Repeat the same step above with the <code>componentDidUpdate</code> and <code>componentWillUnmount</code> methods.</td>
</tr>
<tr>
<td style="text-align:left">4. Try interacting with the <code>CaughtPokemon</code> component in your web browser (clicking the button) while looking at the JavaScript console. What order do the logs appear?</td>
</tr>
<tr>
<td style="text-align:left">5. The <code>componentWillUnmount</code> method will never be called. Can you explain why?</td>
</tr>
</tbody>
</table>
<p>We&apos;ll now focus on a few of the lifecycle hooks and see how they are used.</p>
<h3 id="componentdidmount-and-componentwillunmount"><code>componentDidMount</code> and <code>componentWillUnmount</code></h3>
<p>The <code>componentDidMount</code> method runs after a component has finished rendering to the DOM. The component is now waiting for a props change or input from the user. It is called only once. We use this lifecycle hook to make changes outside of the component (sometimes these are called <em>side effects</em>).</p>
<p>The <code>componentWillUnmount</code> method runs when a component has been unmounted from the DOM. It is used to &quot;clean up&quot; the component as it is no longer being shown. Often we need to close down or cancel the changes we made in <code>componentDidMount</code>.</p>
<p>To look at these in more detail, we&apos;ll create a Clock component in an exercise.</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open <a href="https://codesandbox.io/s/toggleable-clock-with-class-components-p9q2wq069j?file=/src/Clock.js" target="_blank">this CodeSandbox</a>.</td>
</tr>
<tr>
<td style="text-align:left">2. Now change the <code>Time</code> component (notice that there are 2 components defined in this file) add a <code>componentDidMount</code> method.</td>
</tr>
<tr>
<td style="text-align:left">3. Within the <code>componentDidMount</code> method use <code>setInterval</code> to call <code>this.tick</code> every 1000 milliseconds (hint: <code>setInterval(this.tick, 1000)</code>).</td>
</tr>
<tr>
<td style="text-align:left">4. Now open the JavaScript console your web browser. What is happening? Can you explain why?</td>
</tr>
<tr>
<td style="text-align:left">5. Keep looking at the JavaScript console and try clicking the &quot;Toggle time&quot; button. What do you think the problem is here? How can we fix it?</td>
</tr>
<tr>
<td style="text-align:left">6. Change the <code>componentDidMount</code> method to assign <code>this.timer</code> to the output of <code>setInterval</code> (hint: <code>this.timer = setInterval(this.tick, 1000)</code>)</td>
</tr>
<tr>
<td style="text-align:left">7. Add a <code>componentWillUnmount</code> method to the <code>Time</code> component</td>
</tr>
<tr>
<td style="text-align:left">8. In the <code>componentWillUnmount</code> method, remove the timer by calling <code>clearInterval(this.timer)</code></td>
</tr>
<tr>
<td style="text-align:left">9. Try clicking the &quot;Toggle time&quot; button again, like in step 5. How have we solved the problem?</td>
</tr>
</tbody>
</table>
<h2 id="fetching-data-with-class-components">Fetching Data with Class Components</h2>
<p>Data fetching with class components is also a bit different than with Hooks. The problem is similar to accessing state, because we can&apos;t use <code>useEffect</code> inside our class components. Instead we can use the class component lifecycle.</p>
<p>The component lifecycle is very important - we don&apos;t want to be calling our API at the wrong time, or multiple times with the same data! If we tried to fetch data in our <code>render</code> method, it would make a request every time props or state changed. This would create lots of unnecessary requests. A similar problem is solved when using <code>useEffect</code> by the dependencies array.</p>
<p>As we saw above, <code>componentDidMount</code> is called only once when the component is first rendered and so it is an ideal place for making requests. Let&apos;s look at an example (<a href="https://codesandbox.io/s/data-fetching-problem-with-class-components-4rkovwq0kw?file=/src/MartianPhotoFetcher.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">MartianPhotoFetcher</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?earth_date=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// We don&apos;t don&apos;t what the img src is when we render :(</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>src<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This example isn&apos;t very useful! We can&apos;t use the data returned from the server in <code>render</code> because the request is asynchronous :( We need React to re-render once the request is resolved - a perfect use for state! Let&apos;s look at an example (<a href="https://codesandbox.io/s/data-fetching-with-setstate-in-class-components-5kk53yx6ll?file=/src/MartianPhotoFetcher.js" target="_blank">interactive example</a>)</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">MartianPhotoFetcher</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    imgSrc<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?earth_date=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          imgSrc<span class="token operator">:</span> data<span class="token punctuation">.</span>photos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>img_src
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now we can see the Martian photo that we fetched from the server!</p>
<p>However we have a bit of a problem - when we first render the component, we don&apos;t have the photo <code>src</code> yet. We first have to initialise it to <code>null</code>. This shows us that we&apos;re missing something from our UI - a <em>loading status</em>.</p>
<p>Let&apos;s look at showing a different UI when the request is loading (<a href="https://codesandbox.io/s/data-fetching-with-loading-state-in-class-components-93zr0xz32r?file=/src/MartianPhotoFetcher.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">MartianPhotoFetcher</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    isLoading<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    imgSrc<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?earth_date=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;api_key=gnesiqnKCJMm8UTYZYi86ZA5RAnrO4TAR9gDstVb</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          imgSrc<span class="token operator">:</span> data<span class="token punctuation">.</span>photos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>img_src
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Loading<span class="token operator">...</span> &#x1F47D;<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Here are the steps that the component takes:</p>
<ul>
<li>Initialise <code>isLoading</code> to <code>true</code></li>
<li>In <code>render</code>, show a loading message because <code>isLoading</code> is true</li>
<li>Once rendered, <code>componentDidMount</code> will trigger the API request</li>
<li>When the request resolves, we set the <code>isLoading</code> state to false and set the data that we want</li>
<li>Changing state triggers a re-render, and because <code>isLoading</code> is false we render the Martian photo</li>
</ul>
<p>We can still improve our component! What happens if we make a request that fails? Our request will error, but we won&apos;t show the error in the browser. Let&apos;s see how we can fix it (<a href="https://codesandbox.io/s/data-fetching-with-error-state-in-class-components-6v9qo90r2r?file=/src/MartianPhotoFetcher.js" target="_blank">interactive example</a>).</p>
<p>First we have to deal with annoying quirk of <code>fetch</code>. You may remember that it doesn&apos;t reject the promise on HTTP errors. The fix is to add another <code>.then</code> before we convert to JSON:</p>
<pre class="language-"><code class="lang-js"><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&apos;HTTP error&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Now we can add our solution - a <code>.catch</code> on the <code>fetch</code> call. Here we reset the loading state and add the error to state.</p>
<pre class="language-"><code class="lang-js"><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    err<span class="token operator">:</span> err
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Now we can check if there&apos;s an error in state and render out an error message:</p>
<pre class="language-"><code class="lang-js"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Loading<span class="token operator">...</span> &#x1F47D;<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Something went wrong &#x1F62D;<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application again and open the <code>src/BestPokemon.js</code> file.</td>
</tr>
<tr>
<td style="text-align:left">1. If you haven&apos;t already, convert the <code>BestPokemon</code> component to a class component.</td>
</tr>
<tr>
<td style="text-align:left">2. Set the initial state to have a key named <code>pokemonNames</code> that is assigned to an empty array <code>[]</code>.</td>
</tr>
<tr>
<td style="text-align:left">3. Add a <code>componentDidMount</code> method to the component.</td>
</tr>
<tr>
<td style="text-align:left">4. Within the <code>componentDidMount</code> method call the <code>fetch()</code> function with this URL: <code>https://pokeapi.co/api/v2/pokedex/1/</code>. What will this do?</td>
</tr>
<tr>
<td style="text-align:left">5. Add a <code>.then()</code> handler into the <code>fetch</code> function (hint: remember this needs to come immediately after the <code>fetch()</code> call) which converts the response from JSON (hint: <code>.then(res =&gt; res.json())</code>)</td>
</tr>
<tr>
<td style="text-align:left">6. Add a second <code>.then()</code> handler after the one we just added, where the callback function will receive an argument called <code>data</code>.</td>
</tr>
<tr>
<td style="text-align:left">7. Within the second <code>.then()</code> callback function, log out the data that we just received (hint: <code>console.log(data.pokemon_entries[0].pokemon_species.name)</code>).</td>
</tr>
<tr>
<td style="text-align:left">8. Now change the <code>console.log()</code> to log out an array instead, with the first, fourth and seventh Pokemon (hint: <code>console.log([data.pokemon_entries[0].pokemon_species.name, data.pokemon_entries[3].pokemon_species.name, data.pokemon_entries[6].pokemon_species.name])</code>).</td>
</tr>
<tr>
<td style="text-align:left">9. Now again within the <code>.then()</code> callback function, call <code>this.setState()</code> to set the <code>pokemonNames</code> key and assign it to the array that we just logged out (you can copy/paste it).</td>
</tr>
<tr>
<td style="text-align:left">10. Inside the <code>render</code> method, remove the old <code>pokemonNames</code> variable and replace it with <code>this.state.pokemonNames</code>. What do you see in your web browser?.</td>
</tr>
<tr>
<td style="text-align:left">11. Add an <code>isLoading</code> piece of state, which is initialised to <code>true</code>.</td>
</tr>
<tr>
<td style="text-align:left">12. When calling <code>this.setState()</code> inside the <code>.then()</code> handler, also set <code>isLoading</code> to <code>false</code>.</td>
</tr>
<tr>
<td style="text-align:left">13. In the <code>render</code> method check if <code>this.state.isLoading</code> is <code>true</code> and return a loading message (e.g. <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span></code>). Otherwise if <code>this.state.isLoading</code> is <code>false</code> then render the loop as we did before.</td>
</tr>
<tr>
<td style="text-align:left">14. <strong>(STRETCH GOAL)</strong> Add some error handling which renders an error message.</td>
</tr>
<tr>
<td style="text-align:left">15. <strong>(STRETCH GOAL)</strong> Explore the data returned from the API. See if you can show some more interesting Pokemon information in your app (hint: try <code>console.log</code>ging different data returned from the API).</td>
</tr>
</tbody>
</table>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="https://dev.to/subdeveloper/migrating-from-class-components-to-react-hooks-4lp3" target="_blank">Converting a class component to a function component with Hooks</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../week-4/lesson.html" class="navigation navigation-prev " aria-label="Previous page: Routing (optional)">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../../node/" class="navigation navigation-next " aria-label="Next page: Node/DB">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Class components (optional)","level":"1.7.5","depth":2,"next":{"title":"Node/DB","level":"1.8","depth":1,"path":"node/index.md","ref":"node/index.md","articles":[{"title":"Week 16 - Node and Express 101","level":"1.8.1","depth":2,"path":"node/week-13/lesson.md","ref":"node/week-13/lesson.md","articles":[]},{"title":"Week 17 - More APIs in Node","level":"1.8.2","depth":2,"path":"node/week-14/lesson.md","ref":"node/week-14/lesson.md","articles":[]},{"title":"Week 18 - Introduction to SQL","level":"1.8.3","depth":2,"path":"db/week-1/lesson.md","ref":"db/week-1/lesson.md","articles":[]},{"title":"Week 19 - More SQL and integration with NodeJS","level":"1.8.4","depth":2,"path":"db/week-2/lesson.md","ref":"db/week-2/lesson.md","articles":[]},{"title":"Week 20 - SQL with NodeJS","level":"1.8.5","depth":2,"path":"db/week-3/lesson.md","ref":"db/week-3/lesson.md","articles":[]},{"title":"Week 21 - NodeJS Workshop","level":"1.8.6","depth":2,"path":"db/week-4/lesson.md","ref":"db/week-4/lesson.md","articles":[]}]},"previous":{"title":"Routing (optional)","level":"1.7.4","depth":2,"path":"react/week-4/lesson.md","ref":"react/week-4/lesson.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["prism","-highlight","todo","scripts"],"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-tomorrow.css"]},"scripts":{"files":["./checkboxRemember.js"]},"todo":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"react/classes-optional/lesson.md","mtime":"2020-08-27T14:42:21.640Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-08-27T14:43:14.388Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-scripts/865192367b808254b99cb0ba7092e452-checkboxRemember.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

