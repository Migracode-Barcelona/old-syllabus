
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Week 15 - Fetching Data Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../week-4/lesson.html" />
    
    
    <link rel="prev" href="../week-2/lesson.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Course</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Before you start
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../others/lesson0.html">
            
                <a href="../../others/lesson0.html">
            
                    
                    Week 0 - Introduction and basic setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../others/house-rules.html">
            
                <a href="../../others/house-rules.html">
            
                    
                    House Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../CODE_OF_CONDUCT.html">
            
                <a href="../../CODE_OF_CONDUCT.html">
            
                    
                    Code of Conduct
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../html-css/">
            
                <a href="../../html-css/">
            
                    
                    HTML/CSS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../html-css/week-01/lesson.html">
            
                <a href="../../html-css/week-01/lesson.html">
            
                    
                    Week 1 - Semantic HTML and CSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../html-css/week-02/lesson.html">
            
                <a href="../../html-css/week-02/lesson.html">
            
                    
                    Week 2 - Responsive Web, Layout and Flexbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../html-css/week-03/lesson.html">
            
                <a href="../../html-css/week-03/lesson.html">
            
                    
                    Week 3 - HTML Forms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../js-core/">
            
                <a href="../../js-core/">
            
                    
                    JavaScript I
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../js-core/week-04/lesson.html">
            
                <a href="../../js-core/week-04/lesson.html">
            
                    
                    Week 4 - Hello JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../js-core/week-05/lesson.html">
            
                <a href="../../js-core/week-05/lesson.html">
            
                    
                    Week 5 - Expressions and Arrays
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../js-core/week-06/lesson.html">
            
                <a href="../../js-core/week-06/lesson.html">
            
                    
                    Week 6 - Loops and callbacks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../js-core-2/">
            
                <a href="../../js-core-2/">
            
                    
                    JavaScript II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../js-core-2/week-07/lesson.html">
            
                <a href="../../js-core-2/week-07/lesson.html">
            
                    
                    Week 7 - Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../js-core-2/week-08/lesson.html">
            
                <a href="../../js-core-2/week-08/lesson.html">
            
                    
                    Week 8 - JS in the Browser
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../js-core-2/week-09/lesson.html">
            
                <a href="../../js-core-2/week-09/lesson.html">
            
                    
                    Week 9 - More JS in the Browser 
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../js-core-3/">
            
                <a href="../../js-core-3/">
            
                    
                    JavaScript III
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../js-core-3/week-10/lesson.html">
            
                <a href="../../js-core-3/week-10/lesson.html">
            
                    
                    Week 10 - ES6 and debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../js-core-3/week-11/lesson.html">
            
                <a href="../../js-core-3/week-11/lesson.html">
            
                    
                    Week 11 - Unit tests and TDD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../js-core-3/week-12/lesson.html">
            
                <a href="../../js-core-3/week-12/lesson.html">
            
                    
                    Week 12 - Recap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../">
            
                <a href="../">
            
                    
                    React
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../week-1/lesson.html">
            
                <a href="../week-1/lesson.html">
            
                    
                    Week 13 - React 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../week-2/lesson.html">
            
                <a href="../week-2/lesson.html">
            
                    
                    Week 14 - Reacting to Changes
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7.3" data-path="lesson.html">
            
                <a href="lesson.html">
            
                    
                    Week 15 - Fetching Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../week-4/lesson.html">
            
                <a href="../week-4/lesson.html">
            
                    
                    Routing (optional)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../node/">
            
                <a href="../../node/">
            
                    
                    Node/DB
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../node/week-13/lesson.html">
            
                <a href="../../node/week-13/lesson.html">
            
                    
                    Week 16 - Node and Express 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../node/week-14/lesson.html">
            
                <a href="../../node/week-14/lesson.html">
            
                    
                    Week 17 - More APIs in Node
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../db/week-1/lesson.html">
            
                <a href="../../db/week-1/lesson.html">
            
                    
                    Week 18 - Introduction to SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../../db/week-2/lesson.html">
            
                <a href="../../db/week-2/lesson.html">
            
                    
                    Week 19 - More SQL and integration with NodeJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../../db/week-3/lesson.html">
            
                <a href="../../db/week-3/lesson.html">
            
                    
                    Week 20 - More integration with NodeJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../../db/week-4/lesson.html">
            
                <a href="../../db/week-4/lesson.html">
            
                    
                    Week 21 - NodeJS Workshop
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Useful information</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../others/useful-links.html">
            
                <a href="../../others/useful-links.html">
            
                    
                    Useful links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../others/PRACTICES.html">
            
                <a href="../../others/PRACTICES.html">
            
                    
                    Coding Standards and Best Practices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../others/making-a-pull-request.html">
            
                <a href="../../others/making-a-pull-request.html">
            
                    
                    Making a Pull Request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../others/career-development.html">
            
                <a href="../../others/career-development.html">
            
                    
                    Career Development
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Other resources</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../others/coding-101.html">
            
                <a href="../../others/coding-101.html">
            
                    
                    Coding 101
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../others/aws-workshop-2.html">
            
                <a href="../../others/aws-workshop-2.html">
            
                    
                    AWS - DynamoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" >
            
                <a target="_blank" href="https://github.com/Thomas-Stewart/syllabus/tree/master/java">
            
                    
                    Java module
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">For Mentors</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../CONTRIBUTING.html">
            
                <a href="../../CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../others/lesson-template.html">
            
                <a href="../../others/lesson-template.html">
            
                    
                    Lesson Template
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Week 15 - Fetching Data</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="react---week-3">React - Week 3</h1>
<hr>
<p><strong>What will we learn today?</strong></p>
<ul>
<li><a href="#recap">Recap</a></li>
<li><a href="#updating-data-fetching-when-props-change">Updating Data Fetching when Props Change</a></li>
<li><a href="#working-with-forms-in-react">Working with forms in React</a></li>
</ul>
<hr>
<h2 id="learning-objectives---react-week-3">Learning Objectives - React Week 3</h2>
<h3 id="data-fetching-advanced">Data fetching (advanced)</h3>
<ul>
<li>Allow effects to update in response to prop changes<ul>
<li>Explain why a component with an effect dependent on props is broken with empty <code>useEffect()</code> dependencies (<code>[]</code>)</li>
<li>Be able to fix a component with an effect dependent on props using the <code>useEffect()</code> dependencies</li>
<li>Can describe the &quot;lifecycle&quot; of a component with <code>useEffect()</code> when props change</li>
</ul>
</li>
</ul>
<h3 id="forms">Forms</h3>
<ul>
<li>Create a simple form in React using the controlled component pattern<ul>
<li>Can initialise state with <code>useState()</code></li>
<li>Be able to set the input <code>value</code> to the state variable</li>
<li>Can explain why the input does not change when typing if <code>onChange</code> is not set</li>
<li>Be able to update the state using an <code>onChange</code> handler</li>
</ul>
</li>
<li>Use data from a submitted form to update the application<ul>
<li>Be able to handle an <code>onSubmit</code> event to the form</li>
<li>Be able to collect the form state variables and use them (setting state, POST request)</li>
</ul>
</li>
</ul>
<hr>
<h2 id="recap">Recap</h2>
<p>Last week we looked at using props and state to create React components that change with user input (<a href="https://codesandbox.io/s/react-3-state-recap-38x3b?file=/src/Counter.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>You clicked <span class="token punctuation">{</span>count<span class="token punctuation">}</span> times<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click me<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Counter<span class="token punctuation">;</span>
</code></pre>
<p>We also looked at fetching data in our React components (<a href="https://codesandbox.io/s/react-3-recap-h2p24?file=/src/MartianPhotoFetcher.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">MartianPhotoFetcher</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>marsPhotos<span class="token punctuation">,</span> setMarsPhotos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?earth_date=2015-6-3&amp;api_key=gnesiqnKCJMm8UTYZYi86ZA5RAnrO4TAR9gDstVb</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token function">setMarsPhotos</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>marsPhotos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>img
        src<span class="token operator">=</span><span class="token punctuation">{</span>marsPhotos<span class="token punctuation">.</span>photos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>img_src<span class="token punctuation">}</span>
        alt<span class="token operator">=</span><span class="token string">&quot;Mars Rover&quot;</span>
        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token string">&quot;100%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> MartianPhotoFetcher<span class="token punctuation">;</span>
</code></pre>
<h2 id="updating-data-fetching-when-props-change">Updating Data Fetching when Props Change</h2>
<p>Last week we looked at how we could fetch data from an API and render it in our React applications. However, there was a problem with the method that we learned before. To understand this problem we first have to understand the <em>lifecycle</em> of a component.</p>
<h3 id="the-circle-of-life">The Circle of Life</h3>
<p>Let&apos;s take a look at an example:</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise A</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open <a href="https://codesandbox.io/s/fetch-with-prop-updates-not-working-x1dox?file=/src/App.js" target="_blank">this CodeSandbox</a>.</td>
</tr>
<tr>
<td style="text-align:left">2. Take 5 minutes to read the code.</td>
</tr>
<tr>
<td style="text-align:left">3. Click the &quot;Fetch image for 2019&quot; button. <strong>If you&apos;re feeling confident</strong>: predict what is going to happen before you click the button.</td>
</tr>
<tr>
<td style="text-align:left">4. Now click the &quot;Fetch image for 2020&quot; button. What did you expect to happen? What actually happened? Can you explain why?</td>
</tr>
</tbody>
</table>
<p>Together let&apos;s &quot;play computer&quot; to break down exactly what is happening with these components:</p>
<ol>
<li>When the page loads, the <code>App</code> function component is called</li>
<li>It doesn&apos;t have any <code>date</code> state already, so we initialise it to an empty string (<code>&quot;&quot;</code>) with <code>useState</code></li>
<li><p>It renders the 2 buttons, but because <code>date</code> is an empty string, it does <strong>not</strong> render the <code>MartianImageFetcher</code> component. Instead <code>null</code> is returned, which means that nothing is rendered</p>
<pre class="language-"><code class="lang-js"> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> <span class="token punctuation">[</span>date<span class="token punctuation">,</span> setDate<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token operator">...</span>

   <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handle2019Click<span class="token punctuation">}</span><span class="token operator">&gt;</span>Fetch image <span class="token keyword">for</span> <span class="token number">2019</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handle2020Click<span class="token punctuation">}</span><span class="token operator">&gt;</span>Fetch image <span class="token keyword">for</span> <span class="token number">2020</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

       <span class="token punctuation">{</span>date <span class="token operator">?</span> <span class="token operator">&lt;</span>MartianImageFetcher date<span class="token operator">=</span><span class="token punctuation">{</span>date<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre>
</li>
<li>When we click the &quot;Fetch image for 2019&quot; button, the <code>handle2019Click</code> click handler is called</li>
<li>The state is set by <code>setDate</code> to be <code>&quot;2019-01-01&quot;</code>, and a re-render is triggered</li>
<li>The <code>App</code> function component is called again</li>
<li><p>This time, <code>useState</code> remembers that we have <code>date</code> state and it is set to <code>&quot;2019-01-01&quot;</code></p>
<pre class="language-"><code class="lang-js"> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token operator">...</span>

   <span class="token keyword">function</span> <span class="token function">handle2019Click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">setDate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-01-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token operator">...</span>

   <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token operator">...</span>
     <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handle2019Click<span class="token punctuation">}</span><span class="token operator">&gt;</span>Fetch image <span class="token keyword">for</span> <span class="token number">2019</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
     <span class="token operator">...</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre>
</li>
<li>Now <code>App</code> <strong>does</strong> render <code>MartianImageFetcher</code> and passes the <code>date</code> state as a prop (also named <code>date</code>)</li>
<li>The <code>MartianImageFetcher</code> function component is called for the first time</li>
<li><code>useState</code> knows that we haven&apos;t got any <code>imgSrc</code> state so initialises it to <code>null</code></li>
<li>We queue an effect, which will run after we render for the first time</li>
<li><p>Because the <code>imgSrc</code> state is set to <code>null</code>, we return <code>null</code>. This means that nothing is rendered</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>imgSrc<span class="token punctuation">,</span> setImgSrc<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imgSrc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li>Now that the component has rendered for the first time, the effect is run</li>
<li>A <code>fetch</code> request is made to the NASA API (&#x1F680;!)</li>
<li><p>When the request data comes back, we set the <code>imgSrc</code> state to a piece of the data, which triggers a re-render</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?earth_date=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
        props<span class="token punctuation">.</span>date
      <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;api_key=gnesiqnKCJMm8UTYZYi86ZA5RAnrO4TAR9gDstVb</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setImgSrc</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>photos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>img_src<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li>The <code>MartianImageFetcher</code> function component is called again</li>
<li><code>useState</code> remembers that the <code>imgSrc</code> state is set to the data from the API</li>
<li>This time, we do <strong>not</strong> queue an effect. We used an empty array (<code>[]</code>) as the <code>useEffect</code> dependencies argument which means that we only queue effects on the <strong>first</strong> render</li>
<li><p>We do have <code>imgSrc</code> state set, so we render the image using the data from the API &#x1F389;</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>imgSrc<span class="token punctuation">,</span> setImgSrc<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token operator">...</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imgSrc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<p>Phew! That was a lot of work just to render an image! But we&apos;re not quite done yet, we still need to find out what happens when we click the &quot;Fetch image for 2020&quot; button:</p>
<ol>
<li>In the <code>App</code> component, the <code>handle2020Click</code> click handler is called</li>
<li>The <code>date</code> state is set to <code>&quot;2020-01-01&quot;</code> and a re-render is triggered</li>
<li>The <code>App</code> function component is called again and the <code>date</code> state is set to <code>&quot;2020-01-01&quot;</code></li>
<li><p>The <code>date</code> prop that is passed to <code>MartianImageFetcher</code> is <strong>different</strong> which means that it has to re-render</p>
<pre class="language-"><code class="lang-js"> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token operator">...</span>

   <span class="token keyword">function</span> <span class="token function">handle2020Click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">setDate</span><span class="token punctuation">(</span><span class="token string">&quot;2020-01-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token operator">...</span>

   <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token operator">...</span>
     <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
       <span class="token operator">...</span>
       <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handle2020Click<span class="token punctuation">}</span><span class="token operator">&gt;</span>Fetch image <span class="token keyword">for</span> <span class="token number">2020</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
       <span class="token operator">...</span>
       <span class="token punctuation">{</span>date <span class="token operator">?</span> <span class="token operator">&lt;</span>MartianImageFetcher<span class="token operator">=</span><span class="token punctuation">{</span>date<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
       <span class="token operator">...</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
     <span class="token operator">...</span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre>
</li>
<li>In the <code>MartianImageFetcher</code> component <code>useState</code> remembers that we already had <code>imgSrc</code> state. It is set to the image from 2019</li>
<li>Again, we do <strong>not</strong> queue the effect because this is a re-render and <code>useEffect</code> has been passed an empty array <code>[]</code></li>
<li><p>Because <code>imgSrc</code> state has been set previously we render the image from 2019</p>
<pre class="language-"><code class="lang-js"> <span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> <span class="token punctuation">[</span>imgSrc<span class="token punctuation">,</span> setImgSrc<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token operator">...</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise B</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Did you spot where the bug was? Discuss with a group of 2 - 3 students where you think the bug is.</td>
</tr>
<tr>
<td style="text-align:left">2. Report back to the rest of the class where you think the bug happened.</td>
</tr>
</tbody>
</table>
<p>The key that the <code>useEffect</code> in <code>MartianImageFetcher</code> is <strong>only run once</strong>. This is because we told React that the queue should be queued on the first render only. However, as we saw, sometimes you need the effect to run again when some data changes. In this case the <code>date</code> prop, changed from <code>&quot;2019-01-01&quot;</code> to <code>&quot;2020-01-01&quot;</code>, meaning that we have to fetch data different data. We call this a <em>dependency</em> of the effect.</p>
<h3 id="useeffect-dependencies-array"><code>useEffect</code> dependencies array</h3>
<p>To solve this problem, we can tell React to queue the effect on the first render <strong>and</strong> when a dependency changes. We do this by adding the dependency variable to the array (<a href="https://codesandbox.io/s/fetch-with-prop-updates-working-64vw3?file=/src/App.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>imgSrc<span class="token punctuation">,</span> setImgSrc<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">.</span>date<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now when the <code>date</code> prop changes, React knows that the effect must be run again, this time with the 2020 data. Because of this behaviour, the second argument to <code>useEffect</code> is called the <em>dependencies argument</em>. We use it whenever we have something in our effect that <em>depends</em> on a variable outside of the effect function.</p>
<p>To help you understand this better, try &quot;playing computer&quot; again, but this time think about what happens when we use <code>[props.date]</code> for the dependencies argument. Think carefully about what changes with step 6 after we click the 2020 button.</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise C</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application from last week and open the <code>src/BestPokemon.js</code> file.</td>
</tr>
<tr>
<td style="text-align:left">2. Copy the <code>BestPokemonSelector</code> component from <a href="https://codesandbox.io/s/bestpokemonselector-component-mdz0o?file=/src/BestPokemonSelector.js" target="_blank">this CodeSandbox</a>. Then paste it into <code>src/BestPokemon.js</code>.</td>
</tr>
<tr>
<td style="text-align:left">3. Change the <code>default export</code> so that it exports <code>BestPokemonSelector</code> instead of <code>BestPokemonFetcher</code>.</td>
</tr>
<tr>
<td style="text-align:left">4. Take a few minutes to read what the <code>BestPokemonSelector</code> component does. If you have questions, ask a Teaching Assistant to help.</td>
</tr>
<tr>
<td style="text-align:left">5. In the <code>BestPokemonFetcher</code> component change the URL to use backticks (<code>`...` </code>) instead of double-quotes (<code>&quot;</code>). Then replace the number 1 with <code>${props.pokemonId}</code>. What will this do? <details><summary>Click here if you don&apos;t know</summary>The URL will contain the pokemonId instead of always fetching the pokemon with id of 1</details></td>
</tr>
<tr>
<td style="text-align:left">6. Open your browser and find the <code>BestPokemonSelector</code> component. <strong>Before you click the buttons</strong>, think about what you expect will happen. Then click the &quot;Fetch Bulbasaur&quot; button to find out what actually happens.</td>
</tr>
<tr>
<td style="text-align:left">7. Refresh the page. What happens now if you click the &quot;Fetch Bulbasaur&quot; button, then click the &quot;Fetch Charmander&quot; button? Is this what you expected? Explain to someone why this happens.</td>
</tr>
<tr>
<td style="text-align:left">8. Fix the bug by adding <code>props.pokemonId</code> to the <code>useEffect</code> dependencies array in <code>BestPokemonFetcher</code>. Remember that you can test if the bug still happens by refreshing the page, clicking one of the buttons, then the other button.</td>
</tr>
</tbody>
</table>
<h3 id="eslint-rules-for-react-hooks">ESLint rules for React Hooks</h3>
<p>As you may have noticed, VSCode highlighted the empty dependencies array when you changed the URL passed to <code>fetch</code> in <code>BestPokemonFetcher</code>.</p>
<p>This is because your React application is using the rules from <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank"><code>eslint-plugin-react-hooks</code></a>, a package created by the developers who make React. It helps you to find bugs in React Hooks code by highlighting places where you might be missing dependencies.</p>
<p>If you see a red squiggly line underneath your <code>useEffect</code> dependencies array, you can hover your mouse over and it will tell you which variable is missing so you can add it to the dependencies array. Here&apos;s an example:</p>
<p><img src="../assets/eslint-hooks-rule.png" alt="React Hooks eslint rule"></p>
<h3 id="loading-state">Loading state</h3>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise D</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open <a href="https://codesandbox.io/s/fetch-with-prop-updates-working-64vw3?file=/src/App.js" target="_blank">this CodeSandbox</a>.</td>
</tr>
<tr>
<td style="text-align:left">2. Click the &quot;Fetch image for 2019&quot; button and wait for the image to load.</td>
</tr>
<tr>
<td style="text-align:left">3. Now click the &quot;Fetch image for 2020&quot; button. Do you think this is a good experience for the user? Explain what you think is wrong to a Teaching Assistant.</td>
</tr>
</tbody>
</table>
<p>In the application above, the image from 2020 takes a while to load. This makes it feel like the app is broken: the user might think that they didn&apos;t actually click the 2020 button or that it is not working correctly. We are not telling the user that <em>something</em> is happening, it&apos;s just taking a bit of time to load.</p>
<p>We can fix this by adding a <em>loading state</em>. Let&apos;s take a look (<a href="https://codesandbox.io/s/fetch-with-loading-state-part-1-7bi9z?file=/src/FetchWithLoadingState.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imgSrc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Loading...&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>imgSrc<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Previously, we were just rendering nothing (by returning <code>null</code>) when we didn&apos;t have any <code>imgSrc</code>. We can tell the user that this by instead rendering something telling them that we&apos;re still waiting for the data to come back.</p>
<p>There is still a problem though: when we click to fetch another image, we still have <code>imgSrc</code> set to the previous image. What we could do instead is set the <code>imgSrc</code> back to <code>null</code> when we know that we&apos;re fetching another image (<a href="https://codesandbox.io/s/fetch-with-loading-state-part-2-dvu6k?file=/src/FetchWithLoadingState.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">MartianImageFetcher</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setImgSrc</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">.</span>date<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise E</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application again and open the <code>src/BestPokemon.js</code> file.</td>
</tr>
<tr>
<td style="text-align:left">2. In the <code>BestPokemonFetcher</code> component, instead of returning <code>null</code> if there is no <code>pokemon</code>, return <code>&quot;Loading...&quot;</code>.</td>
</tr>
<tr>
<td style="text-align:left">3. Now add <code>setPokemon(null)</code> inside the <code>useEffect</code> callback, before the call to <code>fetch</code>.</td>
</tr>
<tr>
<td style="text-align:left">4. Try clicking on the &quot;Fetch Bulbasaur&quot; and &quot;Fetch Charmander&quot; buttons quickly. Do you see the loading state? (It may only appear for a flash, the Pokemon API is very fast).</td>
</tr>
</tbody>
</table>
<h2 id="working-with-forms-in-react">Working with forms in React</h2>
<p>Modern web applications often involve interacting with forms such as creating an account, adding a blog post or posting a comment. This would involve using inputs, buttons and various form elements and being able to get the values entered by users to do something with it (like display them on a page or send them in a POST request). So, how do we do this in React?</p>
<p>A popular pattern for building forms and collect user data is the <em>controlled component</em> pattern. A <em>pattern</em> is a repeated solution to a problem that is useful in multiple similar cases. Let&apos;s have a look at an example (<a href="https://codesandbox.io/s/controlled-component-4jq1yqy8kx?file=/src/SimpleReminder.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">SimpleReminder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>reminder<span class="token punctuation">,</span> setReminder<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setReminder</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input
        type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
        placeholder<span class="token operator">=</span><span class="token string">&quot;Some reminder&quot;</span>
        value<span class="token operator">=</span><span class="token punctuation">{</span>reminder<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Today <span class="token constant">I</span> need to remember to<span class="token operator">...</span> <span class="token punctuation">{</span>reminder<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We&apos;re controlling the <code>value</code> of the input by using the value from the <code>reminder</code> state. This means that we can only change the value by updating the state.</p>
<p>It is done using the <code>onChange</code> attribute and the <code>handleChange</code> function which is called every time the input value changes (typically when a new character is added or removed).</p>
<p>If we didn&apos;t call <code>setReminder</code> in the <code>handleChange</code> function, then the input&apos;s value would never change and it would appear as if you couldn&apos;t type in the input! Finally, the value we keep in the <code>reminder</code> state is displayed on the screen as today&apos;s reminder.</p>
<p>In addition, instead of just saving the value of the input in the state, we could have also transformed the string before we set it with <code>setReminder</code>, for example by calling <code>toUpperCase()</code> on the string.</p>
<h3 id="form-with-multiple-fields">Form with Multiple Fields</h3>
<p>Let&apos;s have a look at a more complex example where we want to build a form to let users enter information to create a personal account (<a href="https://codesandbox.io/s/controlled-component-createaccountform-m7p083zn6p?file=/src/CreateAccountForm.js" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">CreateAccountForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>userData<span class="token punctuation">,</span> setUserData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> updatedUserData <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>userData<span class="token punctuation">,</span>
      <span class="token punctuation">[</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token operator">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">setUserData</span><span class="token punctuation">(</span>updatedUserData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Do something with the form values...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Username = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userData<span class="token punctuation">.</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Email = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userData<span class="token punctuation">.</span>email<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Password = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userData<span class="token punctuation">.</span>password<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
          name<span class="token operator">=</span><span class="token string">&quot;username&quot;</span>
          placeholder<span class="token operator">=</span><span class="token string">&quot;Username&quot;</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span>userData<span class="token punctuation">.</span>username<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
          name<span class="token operator">=</span><span class="token string">&quot;email&quot;</span>
          placeholder<span class="token operator">=</span><span class="token string">&quot;Email&quot;</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span>userData<span class="token punctuation">.</span>email<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">&quot;password&quot;</span>
          name<span class="token operator">=</span><span class="token string">&quot;password&quot;</span>
          placeholder<span class="token operator">=</span><span class="token string">&quot;Password&quot;</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span>userData<span class="token punctuation">.</span>password<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>submit<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        Create account
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We now have three different inputs named <code>username</code>, <code>email</code> and <code>password</code>, and we keep each entered value in state as a field in an object. The method <code>handleChange</code> is reused to keep track of changes for <strong>all</strong> the values. The trick here is to use the <code>name</code> of the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code> element to update the corresponding state.</p>
<h4 id="updating-an-object-in-state">Updating an Object in State</h4>
<p>Did you spot the strange syntax in <code>handleChange</code>?</p>
<p>We are using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#Spread_in_object_literals" target="_blank">object spread</a> syntax, which copies properties from one object to another. We are using this to update the state object but without <em>mutating</em> the original object.</p>
<p>Let&apos;s break this down into 2 steps. Here we create a <strong>new</strong> object based on another object, and <strong>adding</strong> a new property (<a href="https://jsbin.com/suyekiwezu/edit?js,console" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> sherlock <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&apos;Sherlock Holmes&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> sherlockAfterMoving <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>sherlock<span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">&apos;221b Baker Street&apos;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sherlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sherlockAfterMoving<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We can also <em>override</em> a property if the keys are the same (<a href="https://jsbin.com/hiwuwobeza/edit?js,console" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> watson <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&apos;John Watson&apos;</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">&apos;123 Fake Road&apos;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> watsonAfterMoving <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>watson<span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">&apos;221b Baker Street&apos;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>watson<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>watsonAfterMoving<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Notice how Watson &quot;moves&quot; from &quot;123 Fake Road&quot; to &quot;221b Baker Street&quot;? Because the <code>address</code> key is in both objects, the <strong>second</strong> one &quot;wins&quot; and overrides the other key.</p>
<p>The second bit of new syntax (<code>[event.target.name]</code>) is called a <em>computed property name</em>. Inside a JavaScript object, you can use a variable wrapped in square brackets which acts as a dynamic key, such as (<a href="https://jsbin.com/jegerohati/edit?js,console" target="_blank">interactive example</a>):</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> theKey <span class="token operator">=</span> <span class="token string">&quot;hat&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> theValue <span class="token operator">=</span> <span class="token string">&quot;Deerstalker Cap&quot;</span>

<span class="token keyword">const</span> sherlockClothes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>theKey<span class="token punctuation">]</span><span class="token operator">:</span> theValue
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sherlockClothes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; { hat: &quot;Deerstalker Cap&quot; }</span>
</code></pre>
<p>We are combining all of the concepts above to make a new object, that has all the same properties as the <code>userData</code> object, except for the property that is computed from <code>event.target.name</code> for the key and <code>event.target.value</code> for the value.</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Exercise F</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1. Open the <code>pokedex</code> React application again and open the <code>src/CaughtPokemon.js</code> file. In this exercise, instead of recording the number of caught Pokemon, we are going to record the names of each Pokemon you caught.</td>
</tr>
<tr>
<td style="text-align:left">2. Render an <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code> before the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span></code> (hint: <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></code>).</td>
</tr>
<tr>
<td style="text-align:left">3. Create a new state variable called <code>pokemonNameInput</code> and initialise to an empty string (<code>&quot;&quot;</code>).</td>
</tr>
<tr>
<td style="text-align:left">4. Add a <code>value</code> property to the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code> which passes the <code>pokemonNameInput</code> state variable.</td>
</tr>
<tr>
<td style="text-align:left">5. Create a new <code>handleInputChange</code> function.</td>
</tr>
<tr>
<td style="text-align:left">6. Add a <code>onChange</code> handler to the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code> that will call <code>handleInputChange</code>.</td>
</tr>
<tr>
<td style="text-align:left">7. Add a parameter called <code>event</code> to the <code>handleInputChange</code> function and add a <code>console.log</code> with <code>event.target.value</code>. In your browser, try writing something in the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code>. What do you see in the JavaScript console?</td>
</tr>
<tr>
<td style="text-align:left">8. Set the <code>pokemonNameInput</code> state variable to <code>event.target.value</code>. In your browser, try writing something in the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code>. What do you see?</td>
</tr>
<tr>
<td style="text-align:left">9. We are now going to save the user input when clicking on the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span></code>. Change the <code>caughtPokemon</code> state variable so that it is initialised as an empty array <code>[]</code>.</td>
</tr>
<tr>
<td style="text-align:left">10. There should now be a bug in your app! The number of caught Pokemon has gone! To fix it, change from rendering <code>caughtPokemon</code> to <code>caughtPokemon.length</code>. Why did this fix the bug?</td>
</tr>
<tr>
<td style="text-align:left">11. We now need to change the <code>catchPokemon</code> function to add the <code>pokemonNameInput</code> state variable into the <code>caughtPokemon</code> array. (Hint: trying using the <code>.concat()</code> method, then calling <code>setCaughtPokemon</code>).</td>
</tr>
<tr>
<td style="text-align:left">12. Open your browser, type a Pokemon name into the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code> and click on the &quot;Catch Pokemon&quot; button. Can you see the number of caught Pokemon incrementing as you click on the button?</td>
</tr>
<tr>
<td style="text-align:left">13. Now we are going to display the names of the caught Pokemon. Instead of rendering <code>caughtPokemon.length</code>, create a <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span></code> element and use the <code>.map()</code> method on the <code>caughtPokemon</code> state variable to loop over each Pokemon and return a <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span></code> element for each.</td>
</tr>
<tr>
<td style="text-align:left">14. Empty the <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span></code> after clicking on the button. To do this, set the state of <code>pokemonNameInput</code> to an empty string <code>&quot;&quot;</code> after we have added it to the <code>caughtPokemon</code> array in the <code>catchPokemon</code> function.</td>
</tr>
<tr>
<td style="text-align:left">14: <strong>(STRETCH GOAL)</strong> Make sure the user cannot add a Pokemon to the <code>caughtPokemon</code> state if the value of <code>pokemonNameInput</code> state is empty.</td>
</tr>
</tbody>
</table>
<h1 id="homework">Homework</h1>
<ol>
<li>If you haven&apos;t already, complete the in-class exercises on your <code>pokedex</code> app</li>
<li>Complete all of the lesson 3 exercises in the <a href="https://github.com/CodeYourFuture/cyf-hotel-react#lesson-3" target="_blank">cyf-hotel-react</a> project. Push them to your GitHub account and complete the <a href="https://form.jotformeu.com/93377027809365" target="_blank">Homework Form</a>, use the form to notify your comments and questions about the exercises </li>
<li>Try to complete the <a href="https://github.com/CodeYourFuture/cyf-hotel-react#stretch-goals" target="_blank">Stretch Goal exercises</a> in the cyf-hotel-react homework</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../week-2/lesson.html" class="navigation navigation-prev " aria-label="Previous page: Week 14 - Reacting to Changes">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../week-4/lesson.html" class="navigation navigation-next " aria-label="Next page: Routing (optional)">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Week 15 - Fetching Data","level":"1.7.3","depth":2,"next":{"title":"Routing (optional)","level":"1.7.4","depth":2,"path":"react/week-4/lesson.md","ref":"react/week-4/lesson.md","articles":[]},"previous":{"title":"Week 14 - Reacting to Changes","level":"1.7.2","depth":2,"path":"react/week-2/lesson.md","ref":"react/week-2/lesson.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["prism","-highlight","todo","scripts"],"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-tomorrow.css"]},"scripts":{"files":["./checkboxRemember.js"]},"todo":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"react/week-3/lesson.md","mtime":"2020-06-23T16:43:25.731Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-06-23T16:44:18.007Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-scripts/865192367b808254b99cb0ba7092e452-checkboxRemember.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

